#!/bin/bash
#
# Short:    Do something when there are no console users
# Author:   Mark J Swift
# Version:  1.0.2
# Modified: 29-Apr-2017
#
# Called by ConsoleUserWarden as follows:    
#   ConsoleUserWarden-NoConsoleUser <ActiveConsoleUser> <PreviousConsoleUser>
#

# ---

# assume that all scripts are in a subdirectory off the main project directory
GLB_sv_ProjectDirPath="$(dirname $(dirname ${0}))"

# Include the CommonLib
. "${GLB_sv_ProjectDirPath}/inc/Common.sh"

# Exit if something went wrong unexpectedly
if test -z "${GLB_sv_ProjectName}"
then
  exit 90
fi

# ---

sv_ActiveConsoleUser="${1}"
sv_PreviousConsoleUser="${2}"

# ---

GLB_nf_logmessage ${GLB_iv_MsgLevelNotice} "No Console User - '${sv_ActiveConsoleUser}' (previously '${sv_PreviousConsoleUser}')"

case ${sv_PreviousConsoleUser} in
init)
  # Changes from 'init' to 'none' at boot time
  ;;

none|loginwindow)
  # Might never happen
  ;;

*)
  GLB_nf_logmessage ${GLB_iv_MsgLevelInfo} "User ${sv_PreviousConsoleUser} logged out"
  say "User ${sv_PreviousConsoleUser} logged out"
  ;;

esac
;;
